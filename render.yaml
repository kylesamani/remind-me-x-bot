# Render Blueprint - Infrastructure as Code
# https://render.com/docs/blueprint-spec

services:
  # Web service for the reminder bot
  - type: web
    name: remind-me-x-bot
    runtime: python
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn wsgi:app --bind 0.0.0.0:$PORT --workers 1 --preload
    healthCheckPath: /health
    plan: free
    envVars:
      # X API Credentials (set these in Render dashboard)
      - key: X_API_KEY
        sync: false
      - key: X_API_SECRET
        sync: false
      - key: X_ACCESS_TOKEN
        sync: false
      - key: X_ACCESS_TOKEN_SECRET
        sync: false
      - key: X_BEARER_TOKEN
        sync: false
      # Bot configuration
      - key: BOT_USERNAME
        value: RemindMeXplz
      # Optimized intervals for paid tiers (30s each)
      - key: MENTION_CHECK_INTERVAL
        value: "30"
      - key: REMINDER_CHECK_INTERVAL
        value: "30"
      # Rate limiting configuration
      - key: RATE_LIMIT_MAX_RETRIES
        value: "5"
      - key: RATE_LIMIT_BASE_DELAY
        value: "1.0"
      - key: RATE_LIMIT_MAX_DELAY
        value: "60.0"
      - key: TIMEZONE
        value: UTC
      # Database URL (automatically set by Render when using their PostgreSQL)
      - key: DATABASE_URL
        fromDatabase:
          name: remind-me-x-db
          property: connectionString

databases:
  # PostgreSQL database for storing reminders
  - name: remind-me-x-db
    plan: free
    databaseName: remindmex
    user: remindmex

